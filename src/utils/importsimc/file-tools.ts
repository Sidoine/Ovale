import { readFileSync, writeFileSync } from "fs";

export function replaceInFile(fileName: string, output: string) {
    let existing = readFileSync(fileName, { encoding: "utf8" });
    const lines = output.split("\n");
    for (const line of lines) {
        if (line.indexOf("//") >= 0 || line.indexOf("`") >= 0) continue;
        existing = existing.split(line.trim()).join("");
    }
    output = existing.replace(
        /\/\/ THIS PART OF THIS FILE IS AUTOMATICALLY GENERATED[^]*\/\/ END/,
        `// THIS PART OF THIS FILE IS AUTOMATICALLY GENERATED
${output}
// END`
    );
    writeFileSync(fileName, output, { encoding: "utf8" });
}
